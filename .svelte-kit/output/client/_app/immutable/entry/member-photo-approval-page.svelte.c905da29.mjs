import{S as ut,i as ht,s as dt,k as E,a as Y,l as k,m as _,c as X,h as m,n as c,G as Ye,p as pe,b as ve,H as f,J as ge,a7 as Be,C as Xe,K as ft,Z as gt,o as pt,ar as vt,as as wt,F as xe,w as he,a1 as Ie,q as re,y as Je,D as De,N as _t,r as ie,z as Ke,E as Ae,A as Qe,I as $e,a2 as Me,u as Oe,T as et,g as tt,d as nt,B as ot}from"../chunks/index.ec65748e.mjs";import{R as bt}from"../chunks/RangeSlider.7f172ae2.mjs";import{e as rt}from"../chunks/forms.8c0a0790.mjs";import{t as Le}from"../chunks/toast.672a6db8.mjs";function it(o,e,t){return o>=e*t?{width:e*t,height:e}:{width:o,height:o/t}}function Ne(o,e,t,s){return{x:st(o.x,e.width,t.width,s),y:st(o.y,e.height,t.height,s)}}function st(o,e,t,s){const i=e*s/2-t/2;return Math.min(i,Math.max(o,-i))}function at(o,e){return Math.sqrt(Math.pow(o.y-e.y,2)+Math.pow(o.x-e.x,2))}function yt(o,e,t,s,i,u=!0){const g=u?Et:kt,r={x:g(100,((e.width-t.width/i)/2-o.x/i)/e.width*100),y:g(100,((e.height-t.height/i)/2-o.y/i)/e.height*100),width:g(100,t.width/e.width*100/i),height:g(100,t.height/e.height*100/i)},h=g(e.naturalWidth,r.width*e.naturalWidth/100,!0),a=g(e.naturalHeight,r.height*e.naturalHeight/100,!0),M=e.naturalWidth>=e.naturalHeight*s?{width:Math.round(a*s),height:a}:{width:h,height:Math.round(h/s)},O={...M,x:g(e.naturalWidth-M.width,r.x*e.naturalWidth/100,!0),y:g(e.naturalHeight-M.height,r.y*e.naturalHeight/100,!0)};return{croppedAreaPercentages:r,croppedAreaPixels:O}}function Et(o,e,t=!1){const s=t?Math.round(e):e;return Math.min(o,Math.max(0,s))}function kt(o,e){return e}function lt(o,e){return{x:(e.x+o.x)/2,y:(e.y+o.y)/2}}const{window:Pt}=wt;function ct(o){let e;return{c(){e=E("div"),this.h()},l(t){e=k(t,"DIV",{class:!0,style:!0,"data-testid":!0}),_(e).forEach(m),this.h()},h(){c(e,"class","cropperArea svelte-4q75l8"),pe(e,"width",o[7].width+"px"),pe(e,"height",o[7].height+"px"),c(e,"data-testid","cropper"),xe(e,"round",o[3]==="round"),xe(e,"grid",o[4])},m(t,s){ve(t,e,s)},p(t,s){s[0]&128&&pe(e,"width",t[7].width+"px"),s[0]&128&&pe(e,"height",t[7].height+"px"),s[0]&8&&xe(e,"round",t[3]==="round"),s[0]&16&&xe(e,"grid",t[4])},d(t){t&&m(e)}}}function xt(o){let e,t,s,i,u,g,r=o[7]&&ct(o);return{c(){e=E("div"),t=E("img"),i=Y(),r&&r.c(),this.h()},l(h){e=k(h,"DIV",{class:!0,"data-testid":!0});var a=_(e);t=k(a,"IMG",{class:!0,src:!0,alt:!0,style:!0,crossorigin:!0}),i=X(a),r&&r.l(a),a.forEach(m),this.h()},h(){c(t,"class","image svelte-4q75l8"),Ye(t.src,s=o[2])||c(t,"src",s),c(t,"alt",""),pe(t,"transform","translate("+o[1].x+"px, "+o[1].y+"px) scale("+o[0]+")"),c(t,"crossorigin",o[5]),c(e,"class","container svelte-4q75l8"),c(e,"data-testid","container")},m(h,a){ve(h,e,a),f(e,t),o[20](t),f(e,i),r&&r.m(e,null),o[21](e),u||(g=[ge(Pt,"resize",o[10]),ge(t,"load",o[9]),ge(e,"mousedown",Be(o[11])),ge(e,"touchstart",Be(o[12])),ge(e,"wheel",Be(o[13]))],u=!0)},p(h,a){a[0]&4&&!Ye(t.src,s=h[2])&&c(t,"src",s),a[0]&3&&pe(t,"transform","translate("+h[1].x+"px, "+h[1].y+"px) scale("+h[0]+")"),a[0]&32&&c(t,"crossorigin",h[5]),h[7]?r?r.p(h,a):(r=ct(h),r.c(),r.m(e,null)):r&&(r.d(1),r=null)},i:Xe,o:Xe,d(h){h&&m(e),o[20](null),r&&r.d(),o[21](null),u=!1,ft(g)}}}function It(o,e,t){let{image:s}=e,{crop:i={x:0,y:0}}=e,{zoom:u=1}=e,{aspect:g=4/3}=e,{minZoom:r=1}=e,{maxZoom:h=3}=e,{cropSize:a=null}=e,{cropShape:q="rect"}=e,{showGrid:M=!0}=e,{zoomSpeed:O=1}=e,{crossOrigin:S=null}=e,{restrictPosition:D=!0}=e,v=null,V={width:0,height:0,naturalWidth:0,naturalHeight:0},P=null,I=null,w=null,H={x:0,y:0},J={x:0,y:0},j=0,z=null,d=null;const L=gt();pt(()=>{w&&w.complete&&de(),P&&(P.addEventListener("gesturestart",b),P.addEventListener("gesturechange",b))}),vt(()=>{P&&(P.removeEventListener("gesturestart",b),P.removeEventListener("gesturechange",b)),C()});const b=n=>n.preventDefault(),C=()=>{typeof document<"u"&&(document.removeEventListener("mousemove",F),document.removeEventListener("mouseup",N),document.removeEventListener("touchmove",G),document.removeEventListener("touchend",N))},de=()=>{ee(),B()},se=()=>a?a.width/a.height:g,ee=()=>{w&&(V={width:w.width,height:w.height,naturalWidth:w.naturalWidth,naturalHeight:w.naturalHeight},t(7,v=a||it(w.width,w.height,g))),P&&(I=P.getBoundingClientRect())},te=n=>({x:Number(n.clientX),y:Number(n.clientY)}),W=n=>({x:Number(n.clientX),y:Number(n.clientY)}),R=n=>{document.addEventListener("mousemove",F),document.addEventListener("mouseup",N),ae(te(n))},F=n=>le(te(n)),T=n=>{document.addEventListener("touchmove",G,{passive:!1}),document.addEventListener("touchend",N),n.touches.length===2?K(n):n.touches.length===1&&ae(W(n.touches[0]))},G=n=>{n.preventDefault(),n.touches.length===2?Z(n):n.touches.length===1&&le(W(n.touches[0]))},ae=({x:n,y:p})=>{H={x:n,y:p},J={x:i.x,y:i.y}},le=({x:n,y:p})=>{z&&window.cancelAnimationFrame(z),z=window.requestAnimationFrame(()=>{if(n===void 0||p===void 0||!v)return;const y=n-H.x,$=p-H.y,U={x:J.x+y,y:J.y+$};t(1,i=D?Ne(U,V,v,u):U)})},N=()=>{C(),B()},K=n=>{const p=W(n.touches[0]),y=W(n.touches[1]);j=at(p,y),ae(lt(p,y))},Z=n=>{const p=W(n.touches[0]),y=W(n.touches[1]),$=lt(p,y);le($),d&&window.cancelAnimationFrame(d),d=window.requestAnimationFrame(()=>{const U=at(p,y),Se=u*(U/j);ce(Se,$),j=U})},Q=n=>{const p=te(n),y=u-n.deltaY*O/200;ce(y,p)},we=({x:n,y:p})=>{if(!I)throw new Error("The Cropper is not mounted");return{x:I.width/2-(n-I.left),y:I.height/2-(p-I.top)}},fe=({x:n,y:p})=>({x:(n+i.x)/u,y:(p+i.y)/u}),ce=(n,p)=>{if(!v)return;const y=we(p),$=fe(y);t(0,u=Math.min(h,Math.max(n,r)));const U={x:$.x*u-y.x,y:$.y*u-y.y};t(1,i=D?Ne(U,V,v,u):U)},B=()=>{if(!v||v.width===0)return;const n=D?Ne(i,V,v,u):i,{croppedAreaPercentages:p,croppedAreaPixels:y}=yt(n,V,v,se(),u,D);L("cropcomplete",{percent:p,pixels:y})};function ne(n){he[n?"unshift":"push"](()=>{w=n,t(6,w)})}function me(n){he[n?"unshift":"push"](()=>{P=n,t(8,P)})}return o.$$set=n=>{"image"in n&&t(2,s=n.image),"crop"in n&&t(1,i=n.crop),"zoom"in n&&t(0,u=n.zoom),"aspect"in n&&t(14,g=n.aspect),"minZoom"in n&&t(15,r=n.minZoom),"maxZoom"in n&&t(16,h=n.maxZoom),"cropSize"in n&&t(17,a=n.cropSize),"cropShape"in n&&t(3,q=n.cropShape),"showGrid"in n&&t(4,M=n.showGrid),"zoomSpeed"in n&&t(18,O=n.zoomSpeed),"crossOrigin"in n&&t(5,S=n.crossOrigin),"restrictPosition"in n&&t(19,D=n.restrictPosition)},o.$$.update=()=>{o.$$.dirty[0]&147520&&w&&t(7,v=a||it(w.width,w.height,g)),o.$$.dirty[0]&1&&u&&B()},[u,i,s,q,M,S,w,v,P,de,ee,R,T,Q,g,r,h,a,O,D,ne,me]}class Dt extends ut{constructor(e){super(),ht(this,e,It,xt,dt,{image:2,crop:1,zoom:0,aspect:14,minZoom:15,maxZoom:16,cropSize:17,cropShape:3,showGrid:4,zoomSpeed:18,crossOrigin:5,restrictPosition:19},null,[-1,-1])}}const At=o=>new Promise((e,t)=>{const s=new Image;s.addEventListener("load",()=>e(s)),s.addEventListener("error",i=>t(i)),s.setAttribute("crossOrigin","anonymous"),s.src=o});async function Mt(o,e,t){const s=await At(o),i=document.createElement("canvas");i.width=e.width,i.height=e.height;const u=i.getContext("2d");u.fillStyle="#ffffff",u.fillRect(0,0,i.width,i.height),u.drawImage(s,e.x,e.y,e.width,e.height,0,0,e.width,e.height);const r=await(await fetch(t)).blob(),h=await createImageBitmap(r),a=u.createPattern(h,"no-repeat");return u.translate(i.width-h.width-10,i.height-h.height-10),u.rect(0,0,i.width,i.height),u.fillStyle=a,u.fill(),i.toDataURL("image/jpeg")}function Ot(o){var Ve,je,Ce,Fe;let e,t,s,i,u,g,r,h,a,q,M,O,S,D,v,V,P,I,w=((Ve=o[5])==null?void 0:Ve.width)+"",H,J,j=((je=o[5])==null?void 0:je.height)+"",z,d,L,b=((Ce=o[0].photoApproval)==null?void 0:Ce.fullName)+"",C,de,se,ee=((Fe=o[0].photoApproval)==null?void 0:Fe.genderName)+"",te,W,R,F,T,G,ae,le,N,K,Z,Q,we,fe,ce,B,ne,me,n,p,y;function $(l){o[12](l)}function U(l){o[13](l)}function Se(l){o[14](l)}let Ee={image:o[8]};o[2]!==void 0&&(Ee.crop=o[2]),o[4]!==void 0&&(Ee.zoom=o[4]),o[3]!==void 0&&(Ee.cropSize=o[3]),a=new Dt({props:Ee}),he.push(()=>Ie(a,"crop",$)),he.push(()=>Ie(a,"zoom",U)),he.push(()=>Ie(a,"cropSize",Se)),a.$on("cropcomplete",o[15]);function mt(l){o[16](l)}let qe={min:1,max:10,step:.01};return o[1]!==void 0&&(qe.values=o[1]),v=new bt({props:qe}),he.push(()=>Ie(v,"values",mt)),{c(){e=Y(),t=E("div"),s=E("div"),i=E("div"),u=re("Fotoğraf Onayı"),g=Y(),r=E("div"),h=E("div"),Je(a.$$.fragment),S=Y(),D=E("div"),Je(v.$$.fragment),P=Y(),I=E("div"),H=re(w),J=re(" x "),z=re(j),d=Y(),L=E("div"),C=re(b),de=Y(),se=E("div"),te=re(ee),W=Y(),R=E("div"),F=E("button"),T=De("svg"),G=De("path"),ae=re(`
                    Onayla`),le=Y(),N=E("form"),K=E("button"),Z=De("svg"),Q=De("path"),we=re(`
                    Sil`),ce=Y(),B=E("form"),ne=E("button"),this.h()},l(l){_t("svelte-2o0478",document.head).forEach(m),e=X(l),t=k(l,"DIV",{});var oe=_(t);s=k(oe,"DIV",{class:!0});var ue=_(s);i=k(ue,"DIV",{class:!0});var _e=_(i);u=ie(_e,"Fotoğraf Onayı"),_e.forEach(m),g=X(ue),r=k(ue,"DIV",{class:!0});var A=_(r);h=k(A,"DIV",{class:!0});var be=_(h);Ke(a.$$.fragment,be),be.forEach(m),S=X(A),D=k(A,"DIV",{});var ye=_(D);Ke(v.$$.fragment,ye),ye.forEach(m),P=X(A),I=k(A,"DIV",{});var ke=_(I);H=ie(ke,w),J=ie(ke," x "),z=ie(ke,j),ke.forEach(m),d=X(A),L=k(A,"DIV",{class:!0});var He=_(L);C=ie(He,b),He.forEach(m),de=X(A),se=k(A,"DIV",{});var ze=_(se);te=ie(ze,ee),ze.forEach(m),W=X(A),R=k(A,"DIV",{class:!0});var Pe=_(R);F=k(Pe,"BUTTON",{class:!0});var Te=_(F);T=Ae(Te,"svg",{xmlns:!0,fill:!0,viewBox:!0,"stroke-width":!0,stroke:!0,class:!0});var We=_(T);G=Ae(We,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,d:!0}),_(G).forEach(m),We.forEach(m),ae=ie(Te,`
                    Onayla`),Te.forEach(m),le=X(Pe),N=k(Pe,"FORM",{action:!0});var Re=_(N);K=k(Re,"BUTTON",{class:!0});var Ze=_(K);Z=Ae(Ze,"svg",{xmlns:!0,fill:!0,viewBox:!0,"stroke-width":!0,stroke:!0,class:!0});var Ge=_(Z);Q=Ae(Ge,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,d:!0}),_(Q).forEach(m),Ge.forEach(m),we=ie(Ze,`
                    Sil`),Ze.forEach(m),Re.forEach(m),Pe.forEach(m),A.forEach(m),ue.forEach(m),oe.forEach(m),ce=X(l),B=k(l,"FORM",{class:!0,action:!0});var Ue=_(B);ne=k(Ue,"BUTTON",{type:!0}),_(ne).forEach(m),Ue.forEach(m),this.h()},h(){document.title="Hesabım • Fotoğraf Onayı",c(i,"class","bg-[#fbfcff] border-b border-gray-100 p-6 rounded-t-lg text-lg font-semibold"),c(h,"class","w-[300px] h-[300px] bg-black relative mx-auto"),c(L,"class","font-semibold text-blue-700"),c(G,"stroke-linecap","round"),c(G,"stroke-linejoin","round"),c(G,"d","M4.5 12.75l6 6 9-13.5"),c(T,"xmlns","http://www.w3.org/2000/svg"),c(T,"fill","none"),c(T,"viewBox","0 0 24 24"),c(T,"stroke-width","1.5"),c(T,"stroke","currentColor"),c(T,"class","w-5 h-5 mr-1 inline-block"),c(F,"class","bg-blue-700 hover:bg-blue-900 py-2 px-4 text-sm md:text-lg md:py-3 md:px-6 text-center rounded-full justify-center text-white block md:inline-block"),c(Q,"stroke-linecap","round"),c(Q,"stroke-linejoin","round"),c(Q,"d","M14.74 9l-.346 9m-4.788 0L9.26 9m9.968-3.21c.342.052.682.107 1.022.166m-1.022-.165L18.16 19.673a2.25 2.25 0 01-2.244 2.077H8.084a2.25 2.25 0 01-2.244-2.077L4.772 5.79m14.456 0a48.108 48.108 0 00-3.478-.397m-12 .562c.34-.059.68-.114 1.022-.165m0 0a48.11 48.11 0 013.478-.397m7.5 0v-.916c0-1.18-.91-2.164-2.09-2.201a51.964 51.964 0 00-3.32 0c-1.18.037-2.09 1.022-2.09 2.201v.916m7.5 0a48.667 48.667 0 00-7.5 0"),c(Z,"xmlns","http://www.w3.org/2000/svg"),c(Z,"fill","none"),c(Z,"viewBox","0 0 24 24"),c(Z,"stroke-width","1.5"),c(Z,"stroke","currentColor"),c(Z,"class","w-5 h-5 mr-1 inline-block"),c(K,"class","bg-red-700 hover:bg-red-900 py-2 px-4 text-sm md:text-lg md:py-3 md:px-6 text-center rounded-full justify-center text-white block md:inline-block"),c(N,"action","?/decline"),c(R,"class","flex gap-4 justify-center"),c(r,"class","flex flex-col gap-4 p-6 text-center"),c(s,"class","grow bg-white rounded-lg shadow-md"),c(ne,"type","submit"),c(B,"class","hidden"),c(B,"action","?/approve")},m(l,x){ve(l,e,x),ve(l,t,x),f(t,s),f(s,i),f(i,u),f(s,g),f(s,r),f(r,h),Qe(a,h,null),f(r,S),f(r,D),Qe(v,D,null),f(r,P),f(r,I),f(I,H),f(I,J),f(I,z),f(r,d),f(r,L),f(L,C),f(r,de),f(r,se),f(se,te),f(r,W),f(r,R),f(R,F),f(F,T),f(T,G),f(F,ae),f(R,le),f(R,N),f(N,K),f(K,Z),f(Z,Q),f(K,we),ve(l,ce,x),ve(l,B,x),f(B,ne),o[18](ne),n=!0,p||(y=[ge(F,"click",o[11]),$e(fe=rt.call(null,N,o[17])),$e(me=rt.call(null,B,o[19]))],p=!0)},p(l,[x]){var _e,A,be,ye;const oe={};x&256&&(oe.image=l[8]),!q&&x&4&&(q=!0,oe.crop=l[2],Me(()=>q=!1)),!M&&x&16&&(M=!0,oe.zoom=l[4],Me(()=>M=!1)),!O&&x&8&&(O=!0,oe.cropSize=l[3],Me(()=>O=!1)),a.$set(oe);const ue={};!V&&x&2&&(V=!0,ue.values=l[1],Me(()=>V=!1)),v.$set(ue),(!n||x&32)&&w!==(w=((_e=l[5])==null?void 0:_e.width)+"")&&Oe(H,w),(!n||x&32)&&j!==(j=((A=l[5])==null?void 0:A.height)+"")&&Oe(z,j),(!n||x&1)&&b!==(b=((be=l[0].photoApproval)==null?void 0:be.fullName)+"")&&Oe(C,b),(!n||x&1)&&ee!==(ee=((ye=l[0].photoApproval)==null?void 0:ye.genderName)+"")&&Oe(te,ee),fe&&et(fe.update)&&x&512&&fe.update.call(null,l[17]),me&&et(me.update)&&x&576&&me.update.call(null,l[19])},i(l){n||(tt(a.$$.fragment,l),tt(v.$$.fragment,l),n=!0)},o(l){nt(a.$$.fragment,l),nt(v.$$.fragment,l),n=!1},d(l){l&&m(e),l&&m(t),ot(a),ot(v),l&&m(ce),l&&m(B),o[18](null),p=!1,ft(y)}}}let Lt="image/jpeg";function St(o,e,t){let s,i,{data:u}=e,g={x:0,y:0,width:300,height:300},r={width:300,height:300},h=1,a="https://netders.com/watermark.png",q,M,O,S=[1];const D=d=>{d.percent,t(5,q=d.pixels)},v=async()=>{const d=await Mt(i,q,a);console.log(d);const L=d.split(",");t(6,M=L[1]),O.click()};function V(d){g=d,t(2,g)}function P(d){h=d,t(4,h),t(1,S)}function I(d){r=d,t(3,r)}const w=d=>D(d.detail);function H(d){S=d,t(1,S)}const J=({data:d})=>(d.set("id",s),({update:L,result:b})=>{b.type==="success"&&(d.photoApproval=b.data,Le("İşlem başarıyla tamamlandı!","success")),b.type==="invalid"&&Object.values(b.data).forEach(C=>{Le(C,"warning")}),L({reset:!0})});function j(d){he[d?"unshift":"push"](()=>{O=d,t(7,O)})}const z=({data:d})=>(d.set("id",s),d.set("photo",M),d.set("photoType",Lt),({update:L,result:b})=>{b.type==="success"&&(d.photoApproval=b.data,Le("İşlem başarıyla tamamlandı!","success")),b.type==="invalid"&&Object.values(b.data).forEach(C=>{Le(C,"warning")}),L({reset:!0})});return o.$$set=d=>{"data"in d&&t(0,u=d.data)},o.$$.update=()=>{o.$$.dirty&2&&S&&t(4,h=S[0]),o.$$.dirty&1&&t(9,s=u.photoApproval.id),o.$$.dirty&1&&t(8,i="https://d1ql1h7f6x0zr6.cloudfront.net/"+u.photoApproval.url)},[u,S,g,r,h,q,M,O,i,s,D,v,V,P,I,w,H,J,j,z]}class qt extends ut{constructor(e){super(),ht(this,e,St,Ot,dt,{data:0})}}export{qt as default};
